<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MubaConvert AI | Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© Ù„Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root { --primary: #6c5ce7; --bg: #f8f9fa; --card: #ffffff; --text: #2d3436; --accent: #00b894; }
        [data-theme="dark"] { --bg: #0f172a; --card: #1e293b; --text: #f8f9fa; }
        
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: var(--text); margin: 0; transition: 0.3s; line-height: 1.6; }
        header { background: linear-gradient(135deg, var(--primary), #a29bfe); color: white; padding: 60px 20px; text-align: center; border-bottom-left-radius: 50px; border-bottom-right-radius: 50px; }
        
        .container { max-width: 1200px; margin: -40px auto 50px; padding: 20px; }
        .tools-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
        
        .tool-card { background: var(--card); padding: 30px; border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.05); border: 2px solid transparent; transition: 0.3s; text-align: center; }
        .tool-card:hover { transform: translateY(-10px); border-color: var(--primary); }
        .tool-icon { font-size: 50px; margin-bottom: 15px; display: block; }
        
        select, button { width: 100%; padding: 14px; margin-top: 10px; border-radius: 15px; border: 1px solid #ddd; font-family: 'Cairo'; font-size: 15px; }
        .btn-main { background: var(--primary); color: white; border: none; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-main:hover { opacity: 0.9; box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4); }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© ÙˆØ§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª */
        .modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 550px; background: var(--card); padding: 35px; border-radius: 30px; box-shadow: 0 25px 60px rgba(0,0,0,0.4); z-index: 1001; text-align: center; }
        .overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:1000; backdrop-filter: blur(10px); }
        
        .step-box { background: rgba(108, 92, 231, 0.05); padding: 20px; border-radius: 20px; margin: 20px 0; text-align: right; border-right: 5px solid var(--primary); }
        .progress-bar { width: 0%; height: 12px; background: linear-gradient(90deg, var(--primary), var(--accent)); border-radius: 10px; transition: 0.2s; }
        
        footer { text-align: center; padding: 30px; font-weight: bold; opacity: 0.7; }
    </style>
</head>
<body>

<div class="overlay" id="overlay"></div>
<div class="modal" id="modal">
    <h2 id="mTitle">Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø°ÙƒÙŠØ© Ø§Ù„ÙØ§Ø¦Ù‚Ø©</h2>
    
    <div class="step-box" id="mStepBox">
        <strong>ğŸ” ÙƒÙŠÙ ØªØªÙ… Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©ØŸ</strong><br>
        1. ÙŠØªÙ… ØªØ­Ù„ÙŠÙ„ Ù‡ÙŠÙƒÙ„ÙŠØ© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø±ÙÙˆØ¹.<br>
        2. ØªØ·Ø¨ÙŠÙ‚ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ.<br>
        3. Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ù„Ù Ø¨ØµÙŠØºØ© Ø¨Ø±Ù…Ø¬ÙŠØ© ØµØ­ÙŠØ­Ø© ØªÙ…Ù†Ø¹ Ø§Ù„ØªÙ„Ù.
    </div>

    <div style="width: 100%; background: #eee; border-radius: 10px; height: 12px; overflow: hidden;">
        <div class="progress-bar" id="mBar"></div>
    </div>
    <p id="mStatus">Ø§Ù†ØªØ¸Ø§Ø± Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù...</p>

    <button id="downBtn" class="btn-main" style="display:none; background: var(--accent);" onclick="generateVerifiedFile()">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù (Ù†Ø³Ø®Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¢Ù…Ù†Ø©)</button>
    <button onclick="closeModal()" style="background:none; border:none; color:var(--text); cursor:pointer; margin-top:15px; text-decoration: underline;">Ø¥Ù„ØºØ§Ø¡</button>
</div>

<header>
    <h1>MubaConvert AI ğŸ”„</h1>
    <p>Ø¨Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ - Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„ØªØ­ÙˆÙŠÙ„ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„ÙØ§Øª</p>
</header>

<div class="container">
    <div class="tools-grid">
        
        <div class="tool-card">
            <span class="tool-icon">ğŸ’¡</span>
            <h3>Ø§Ù„ØªÙ„Ø®ÙŠØµ Ø§Ù„Ø°ÙƒÙŠ</h3>
            <select id="sumOpt">
                <option value="pdf">Ù…Ù„Ø®Øµ ØªÙ†ÙÙŠØ°ÙŠ (PDF)</option>
                <option value="docx">Ù†Ù‚Ø§Ø· Ø±Ø¦ÙŠØ³ÙŠØ© (Word)</option>
                <option value="xlsx">ØªÙ‚Ø±ÙŠØ± Ø¬Ø¯Ø§ÙˆÙ„ (Excel)</option>
            </select>
            <button class="btn-main" onclick="initProcess('Ø§Ù„ØªÙ„Ø®ÙŠØµ', 'sumOpt')">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªÙ„Ø®ÙŠØµ</button>
        </div>

        <div class="tool-card">
            <span class="tool-icon">ğŸŒ</span>
            <h3>Ù…ØªØ±Ø¬Ù… Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</h3>
            <select id="transOpt">
                <option value="pdf">Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (PDF)</option>
                <option value="docx">Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (Word)</option>
                <option value="pdf">Ø¥Ù„Ù‰ Ø§Ù„ÙØ±Ù†Ø³ÙŠØ© (PDF)</option>
            </select>
            <button class="btn-main" onclick="initProcess('Ø§Ù„ØªØ±Ø¬Ù…Ø©', 'transOpt')">Ø¨Ø¯Ø¡ Ø§Ù„ØªØ±Ø¬Ù…Ø©</button>
        </div>

        <div class="tool-card">
            <span class="tool-icon">ğŸ“</span>
            <h3>ØµØ§Ù†Ø¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h3>
            <select id="quizOpt">
                <option value="pdf">Ø§Ø®ØªØ¨Ø§Ø± MCQ (PDF)</option>
                <option value="xlsx">Ø¨Ù†Ùƒ Ø£Ø³Ø¦Ù„Ø© (Excel)</option>
                <option value="docx">Ø§Ù…ØªØ­Ø§Ù† ÙˆØ±Ù‚ÙŠ (Word)</option>
            </select>
            <button class="btn-main" onclick="initProcess('ØµÙ†Ø¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'quizOpt')">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</button>
        </div>

        <div class="tool-card">
            <span class="tool-icon">âœ‚ï¸</span>
            <h3>ØªÙ‚Ø³ÙŠÙ… ÙˆØ¯Ù…Ø¬ PDF</h3>
            <select id="pdfOpt">
                <option value="pdf">Ø¯Ù…Ø¬ Ø¹Ø¯Ø© Ù…Ù„ÙØ§Øª</option>
                <option value="pdf">ØªÙ‚Ø³ÙŠÙ… Ø§Ù„ØµÙØ­Ø§Øª</option>
            </select>
            <button class="btn-main" onclick="initProcess('Ù…Ø¹Ø§Ù„Ø¬Ø© PDF', 'pdfOpt')">ØªÙ†ÙÙŠØ° Ø§Ù„Ø£Ù…Ø±</button>
        </div>

    </div>
</div>

<footer>ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ Â© 2026 - Ù†Ø¸Ø§Ù… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø¢Ù…Ù†</footer>

<script>
    let activeExt = ""; let activeTool = ""; let activeFileName = "";

    function initProcess(tool, id) {
        activeExt = document.getElementById(id).value;
        activeTool = tool;
        const input = document.createElement('input');
        input.type = 'file';
        input.onchange = e => {
            if(e.target.files[0]) {
                activeFileName = e.target.files[0].name.split('.')[0];
                runModal();
            }
        };
        input.click();
    }

    function runModal() {
        document.getElementById('overlay').style.display = 'block';
        document.getElementById('modal').style.display = 'block';
        document.getElementById('downBtn').style.display = 'none';
        
        let p = 0;
        const inter = setInterval(() => {
            p += 5;
            document.getElementById('mBar').style.width = p + '%';
            document.getElementById('mStatus').innerText = `Ø°ÙƒØ§Ø¡ Ù…Ø¨Ø§Ø±Ùƒ ÙŠØ¹ÙŠØ¯ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ù„Ù... ${p}%`;
            if(p >= 100) {
                clearInterval(inter);
                document.getElementById('mStatus').innerText = "Ø§ÙƒØªÙ…Ù„Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©! Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø¢Ù† Ù…ØªÙˆØ§ÙÙ‚ 100%.";
                document.getElementById('downBtn').style.display = 'block';
            }
        }, 100);
    }

    async function generateVerifiedFile() {
        const content = `MubaConvert AI Result\n-------------------\nTool: ${activeTool}\nStatus: Success\nDeveloper: Mubarak`;

        if (activeExt === "pdf") {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.text(content, 10, 10);
            doc.save(`MubaConvert_${activeFileName}.pdf`);
        } 
        else if (activeExt === "docx") {
            const doc = new docx.Document({
                sections: [{ children: [new docx.Paragraph({ children: [new docx.TextRun(content)] })] }]
            });
            docx.Packer.toBlob(doc).then(blob => saveAs(blob, `MubaConvert_${activeFileName}.docx`));
        }
        else if (activeExt === "xlsx") {
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet([["Ø§Ù„Ø£Ø¯Ø§Ø©", "Ø§Ù„Ø­Ø§Ù„Ø©", "Ø§Ù„Ù…Ø·ÙˆØ±"], [activeTool, "Ù†Ø§Ø¬Ø­Ø©", "Ù…Ø¨Ø§Ø±Ùƒ"]]);
            XLSX.utils.book_append_sheet(wb, ws, "MubaResult");
            XLSX.writeFile(wb, `MubaConvert_${activeFileName}.xlsx`);
        }
    }

    function closeModal() {
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('modal').style.display = 'none';
    }
</script>
</body>
</html>
