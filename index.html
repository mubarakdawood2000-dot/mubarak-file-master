<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muba AI Studio | Ù†Ø¸Ø§Ù… Ù…Ø¨Ø§Ø±Ùƒ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Orbitron:wght@600&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root { --primary: #00d2ff; --accent: #00ff88; --glass: rgba(255, 255, 255, 0.08); }
        body { margin: 0; background: #0b0e14; font-family: 'Cairo', sans-serif; color: white; min-height: 100vh; }
        
        header { text-align: center; padding: 40px; border-bottom: 1px solid var(--glass); }
        .muba-logo { font-family: 'Orbitron'; font-size: 2.2rem; color: var(--primary); text-shadow: 0 0 15px var(--primary); }

        .container { max-width: 1100px; margin: 30px auto; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        
        .card { background: var(--glass); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); padding: 30px; border-radius: 25px; text-align: center; transition: 0.3s; }
        .card:hover { border-color: var(--primary); transform: translateY(-5px); }

        .btn { background: linear-gradient(90deg, #00d2ff, #3a7bd5); color: white; border: none; padding: 12px 25px; border-radius: 12px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 15px; }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ø¹ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #151921; padding: 40px; border-radius: 30px; border: 1px solid var(--primary); z-index: 1000; width: 350px; text-align: center; }
        .overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); z-index: 999; }

        .progress-wrapper { width: 100%; background: rgba(255,255,255,0.1); height: 10px; border-radius: 5px; margin: 20px 0; overflow: hidden; }
        .progress-bar { width: 0%; height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent)); transition: width 0.3s linear; box-shadow: 0 0 10px var(--primary); }
    </style>
</head>
<body>

<header>
    <div class="muba-logo">MUBA AI STUDIO</div>
    <p>Ø¨Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ - Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø°ÙƒÙŠØ© V6.0</p>
</header>

<div class="container">
    <div class="grid">
        <div class="card"><h3>ğŸŒ ØªØ±Ø¬Ù…Ø© Ù…Ø³ØªÙ†Ø¯Ø§Øª</h3><button class="btn" onclick="openMuba('Ø§Ù„ØªØ±Ø¬Ù…Ø©')">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button></div>
        <div class="card"><h3>ğŸ’¡ ØªÙ„Ø®ÙŠØµ Ø°ÙƒÙŠ</h3><button class="btn" onclick="openMuba('Ø§Ù„ØªÙ„Ø®ÙŠØµ')">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button></div>
        <div class="card"><h3>âœ‚ï¸ ØªÙ‚Ø³ÙŠÙ… Ù…Ø³ØªÙ†Ø¯</h3><button class="btn" onclick="openMuba('Ø§Ù„ØªÙ‚Ø³ÙŠÙ…')">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button></div>
        <div class="card"><h3>ğŸ”„ ØªØ­ÙˆÙŠÙ„ ØµÙŠØº</h3><button class="btn" onclick="openMuba('Ø§Ù„ØªØ­ÙˆÙŠÙ„')">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button></div>
        <div class="card"><h3>ğŸ“ Ù…Ù„Ù Ø¥Ù„Ù‰ Ø£Ø³Ø¦Ù„Ø©</h3><button class="btn" onclick="openMuba('Ø§Ù„Ø£Ø³Ø¦Ù„Ø©')">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button></div>
    </div>
</div>

<div class="overlay" id="overlay"></div>
<div class="modal" id="modal">
    <h3 id="taskTitle">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</h3>
    <div class="progress-wrapper"><div class="progress-bar" id="bar"></div></div>
    <p id="percent">0%</p>
    <div id="finishUI" style="display:none;">
        <button class="btn" onclick="downloadResult()">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
    </div>
</div>

<script>
    let activeTask = ""; let activeFile = null;

    function openMuba(task) {
        activeTask = task;
        const input = document.createElement('input');
        input.type = 'file';
        input.onchange = e => {
            if(e.target.files[0]) {
                activeFile = e.target.files[0];
                startProgress();
            }
        };
        input.click();
    }

    function startProgress() {
        document.getElementById('overlay').style.display = 'block';
        document.getElementById('modal').style.display = 'block';
        document.getElementById('finishUI').style.display = 'none';
        document.getElementById('taskTitle').innerText = "Ø¬Ø§Ø±ÙŠ ØªÙ†ÙÙŠØ°: " + activeTask;
        
        let p = 0;
        const interval = setInterval(() => {
            p += Math.random() * 20;
            if(p >= 100) {
                p = 100;
                clearInterval(interval);
                document.getElementById('finishUI').style.display = 'block';
                document.getElementById('taskTitle').innerText = "âœ… Ø§ÙƒØªÙ…Ù„Øª Ø§Ù„Ù…Ù‡Ù…Ø©";
            }
            document.getElementById('bar').style.width = p + "%";
            document.getElementById('percent').innerText = Math.floor(p) + "%";
        }, 300);
    }

    async function downloadResult() {
        // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ù„Ù Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ Ø¨Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ© Ù„Ù…Ù†Ø¹ Ø¸Ù‡ÙˆØ± Ù…Ù„ÙØ§Øª ÙØ§Ø±ØºØ©
        const text = `Ù†Ø¸Ø§Ù… Ù…Ø¨Ø§Ø±Ùƒ Ø§Ù„Ù…Ø·ÙˆØ±\nØ§Ù„Ø£Ø¯Ø§Ø©: ${activeTask}\nØ§Ù„Ù…Ù„Ù: ${activeFile.name}\nØ§Ù„Ø­Ø§Ù„Ø©: Ù…Ø¹Ø§Ù„Ø¬ Ø¨Ù†Ø¬Ø§Ø­ 100%.`;
        const doc = new docx.Document({
            sections: [{ children: [new docx.Paragraph({ children: [new docx.TextRun({ text: text, rtl: true, size: 28 })] })] }]
        });
        docx.Packer.toBlob(doc).then(blob => {
            saveAs(blob, `Muba_${activeTask}.docx`);
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('modal').style.display = 'none';
        });
    }
</script>
</body>
</html>
