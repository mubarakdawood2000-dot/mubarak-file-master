<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MubaConvert AI | Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„ØµÙˆØªÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root { --primary: #6c5ce7; --bg: #f8f9fa; --card: #ffffff; --text: #2d3436; --accent: #00b894; }
        [data-theme="dark"] { --bg: #0f172a; --card: #1e293b; --text: #f8f9fa; }
        
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: var(--text); margin: 0; transition: 0.3s; }
        header { background: linear-gradient(135deg, var(--primary), #a29bfe); color: white; padding: 50px 20px; text-align: center; border-bottom-left-radius: 50px; border-bottom-right-radius: 50px; position: relative; }
        
        .container { max-width: 1100px; margin: -30px auto 50px; padding: 20px; }
        .main-card { background: var(--card); padding: 40px; border-radius: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.05); text-align: center; border: 1px solid rgba(0,0,0,0.1); }
        
        .countdown-container { display: none; margin: 20px 0; }
        .loader { width: 80px; height: 80px; border: 8px solid #eee; border-top: 8px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .format-list { display: none; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin-top: 30px; }
        .btn-format { background: var(--card); border: 2px solid var(--primary); color: var(--text); padding: 15px; border-radius: 20px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-format:hover { background: var(--primary); color: white; transform: translateY(-3px); }

        .theme-btn { position: absolute; top: 20px; left: 20px; background: rgba(255,255,255,0.2); border: none; color: white; padding: 10px; border-radius: 50%; cursor: pointer; }
    </style>
</head>
<body onload="initMuba()">

<audio id="successSound" src="https://actions.google.com/sounds/v1/communication/notification_high_intensity.ogg"></audio>
<audio id="clickSound" src="https://actions.google.com/sounds/v1/foley/button_click.ogg"></audio>

<header>
    <button class="theme-btn" onclick="toggleMubaTheme()">ğŸŒ“</button>
    <h1>MubaConvert AI ğŸ”„</h1>
    <p>Ø¨Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ - Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨Ø§Ù„ØµÙˆØª ÙˆØ§Ù„Ø¶ÙˆØ¡</p>
</header>

<div class="container">
    <div class="main-card">
        <div id="uploadUI">
            <span style="font-size: 60px;">ğŸ“</span>
            <h2>Ø§Ø¨Ø¯Ø£ ØªØ­ÙˆÙŠÙ„ Ù…Ù„ÙØ§ØªÙƒ</h2>
            <button class="btn-format" style="width: 250px; background: var(--primary); color: white;" onclick="handleUpload()">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù„Ù</button>
        </div>

        <div id="countdownUI" class="countdown-container">
            <div class="loader"></div>
            <h2 id="timerText" style="color: var(--primary);">3</h2>
            <p>Ø°ÙƒØ§Ø¡ Ù…Ø¨Ø§Ø±Ùƒ ÙŠØ­Ù„Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆÙŠØ¤Ù…Ù† Ø§Ù„Ù…Ù„Ù</p>
        </div>

        <div id="formatUI" class="format-list">
            <button class="btn-format" onclick="downloadFile('docx')">WORD (Ø¹Ø±Ø¨ÙŠ)</button>
            <button class="btn-format" onclick="downloadFile('xlsx')">EXCEL</button>
            <button class="btn-format" onclick="downloadFile('pdf')">PDF</button>
        </div>
    </div>
</div>

<script>
    let uploadedFile = null;

    function initMuba() {
        const theme = localStorage.getItem('mubaTheme') || 'light';
        document.documentElement.setAttribute('data-theme', theme);
    }

    function toggleMubaTheme() {
        const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('mubaTheme', theme);
    }

    function handleUpload() {
        document.getElementById('clickSound').play();
        const input = document.createElement('input');
        input.type = 'file';
        input.onchange = e => {
            if(e.target.files[0]) {
                uploadedFile = e.target.files[0];
                startTimer();
            }
        };
        input.click();
    }

    function startTimer() {
        document.getElementById('uploadUI').style.display = 'none';
        document.getElementById('countdownUI').style.display = 'block';
        let timeLeft = 3;
        
        const timer = setInterval(() => {
            timeLeft--;
            document.getElementById('timerText').innerText = timeLeft;
            
            if(timeLeft <= 0) {
                clearInterval(timer);
                document.getElementById('successSound').play(); // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ù†Ø¬Ø§Ø­
                document.getElementById('countdownUI').style.display = 'none';
                document.getElementById('formatUI').style.display = 'grid';
            }
        }, 1000);
    }

    async function downloadFile(format) {
        document.getElementById('clickSound').play();
        const content = `Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ\nØ§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬: ${uploadedFile.name}\nØ§Ù„Ø­Ø§Ù„Ø©: Ø¬Ø§Ù‡Ø² 100%`;

        if (format === 'docx') {
            const doc = new docx.Document({ sections: [{ children: [new docx.Paragraph({ children: [new docx.TextRun({ text: content, rtl: true })] })] }] });
            docx.Packer.toBlob(doc).then(blob => saveAs(blob, `Muba_${uploadedFile.name}.docx`));
        } else if (format === 'xlsx') {
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet([["Ù†Ø¸Ø§Ù… Ù…Ø¨Ø§Ø±Ùƒ"], [content]]);
            XLSX.utils.book_append_sheet(wb, ws, "MubaResult");
            XLSX.writeFile(wb, `Muba_${uploadedFile.name}.xlsx`);
        } else {
            const doc = new jspdf.jsPDF();
            doc.text("MubaConvert AI", 10, 10);
            doc.text("Success Process", 10, 20);
            doc.save(`Muba_${uploadedFile.name}.pdf`);
        }
        
        setTimeout(() => { location.reload(); }, 2000);
    }
</script>
</body>
</html>
