<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muba AI Studio | Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Orbitron:wght@600&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root { --primary: #00d2ff; --bg: #0b0e14; --glass: rgba(255, 255, 255, 0.05); }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Cairo', sans-serif; overflow-x: hidden; }
        
        /* Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªØ±Ø­ÙŠØ¨ (Welcome Guide) */
        .welcome-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 2000;
            display: flex; align-items: center; justify-content: center;
            backdrop-filter: blur(10px);
        }
        .welcome-card {
            background: #1e293b; padding: 40px; border-radius: 30px;
            max-width: 500px; text-align: center; border: 1px solid var(--primary);
            box-shadow: 0 0 50px rgba(0, 210, 255, 0.2);
        }

        nav { padding: 20px 50px; background: rgba(0,0,0,0.4); display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--primary); }
        .logo { font-family: 'Orbitron'; color: var(--primary); font-size: 1.6rem; text-shadow: 0 0 10px var(--primary); }

        .container { max-width: 950px; margin: 40px auto; padding: 20px; }
        
        .upload-card {
            background: var(--glass); border: 2px dashed rgba(0, 210, 255, 0.3);
            border-radius: 40px; padding: 60px; text-align: center; cursor: pointer; transition: 0.4s;
        }

        .preview-pane {
            display: none; background: #ffffff; color: #1e293b; margin-top: 30px;
            border-radius: 30px; box-shadow: 0 30px 60px rgba(0,0,0,0.5);
        }
        .preview-content { padding: 50px; text-align: right; font-size: 18px; }

        .muba-signature {
            margin-top: 40px; padding-top: 20px; border-top: 2px solid #eee;
            display: flex; align-items: center; gap: 15px;
        }
        .sig-badge { border: 2px solid var(--primary); color: var(--primary); padding: 5px 15px; border-radius: 8px; font-weight: bold; }

        .btn { padding: 15px 30px; border-radius: 15px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-primary { background: var(--primary); color: #000; }
    </style>
</head>
<body>

<div class="welcome-overlay" id="welcomeGuide">
    <div class="welcome-card">
        <div style="font-size: 50px;">ğŸ‘‹</div>
        <h2 style="color: var(--primary);">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Muba AI</h2>
        <p>Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø¨Ø°ÙƒØ§Ø¡.</p>
        <ul style="text-align: right; font-size: 14px; line-height: 2;">
            <li>ğŸ›¡ï¸ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¢Ù…Ù†Ø© ØªÙ…Ù†Ø¹ ØªÙ„Ù Ø§Ù„Ù…Ù„ÙØ§Øª.</li>
            <li>ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø© ÙÙˆØ±ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø£Ùˆ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©.</li>
            <li>âœï¸ Ø®ØªÙ… Ø¬ÙˆØ¯Ø© Ø±Ù‚Ù…ÙŠ Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ø³ØªÙ†Ø¯.</li>
        </ul>
        <button class="btn btn-primary" onclick="closeGuide()">Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¢Ù†</button>
    </div>
</div>

<nav>
    <div class="logo">MUBA AI ULTIMATE</div>
    <button onclick="showGuide()" style="background:none; border:1px solid var(--primary); color:var(--primary); cursor:pointer; border-radius:10px;">ØŸ Ø§Ù„Ø¯Ù„ÙŠÙ„</button>
</nav>

<div class="container">
    <div class="upload-card" onclick="document.getElementById('fileInput').click()">
        <div style="font-size: 70px;">ğŸ’</div>
        <h2>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…ÙˆØ«Ù‚Ø©</h2>
        <p>Ø±ÙØ¹ Ø¢Ù…Ù† - Ù…Ø¹Ø§ÙŠÙ†Ø© Ø°ÙƒÙŠØ© - Ø®ØªÙ… Ø¬ÙˆØ¯Ø© Ø±Ù‚Ù…ÙŠ</p>
        <input type="file" id="fileInput" hidden onchange="processMubaFile(this.files[0])">
    </div>

    <div class="preview-pane" id="previewPane">
        <div class="preview-content">
            <div id="textContent"></div>
            <div class="muba-signature">
                <div class="sig-badge">VERIFIED BY MUBA AI</div>
                <div style="font-size: 12px; color: #64748b;">Ù…Ø³ØªÙ†Ø¯ Ù…Ø¹ØªÙ…Ø¯ Ù…Ù† Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ</div>
            </div>
        </div>
        <div style="padding: 20px 50px 40px; display: flex; gap: 10px;">
            <button class="btn" onclick="window.print()" style="background:#475569; color:white;">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
            <button class="btn btn-primary" onclick="exportDoc()" style="flex:1;">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø¨Ø®ØªÙ… Ø§Ù„Ø¬ÙˆØ¯Ø©</button>
        </div>
    </div>
</div>

<script>
    function closeGuide() { document.getElementById('welcomeGuide').style.display = 'none'; }
    function showGuide() { document.getElementById('welcomeGuide').style.display = 'flex'; }

    let activeName = "";
    function processMubaFile(file) {
        if(!file) return;
        activeName = file.name;
        document.getElementById('textContent').innerHTML = `<h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ù„Ù„Ù…Ù„Ù: ${activeName}</h3><p>ØªÙ… ÙØ­Øµ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªÙˆØ§ÙÙ‚ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© 100%. Ø§Ù„Ù…Ù„Ù Ø¬Ø§Ù‡Ø² Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© Ø£Ùˆ Ø§Ù„ØªØµØ¯ÙŠØ± Ù…Ø¹ Ø§Ù„Ø®ØªÙ… Ø§Ù„Ø±Ù‚Ù…ÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¨Ø§Ø±Ùƒ.</p>`;
        document.getElementById('previewPane').style.display = 'block';
    }

    async function exportDoc() {
        const doc = new docx.Document({
            sections: [{
                children: [
                    new docx.Paragraph({ children: [new docx.TextRun({ text: "Certified by Muba AI", bold: true, size: 30 })] }),
                    new docx.Paragraph({ children: [new docx.TextRun({ text: "ØªÙ…Øª Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¨Ù†Ø¬Ø§Ø­.", rtl: true })] })
                ]
            }]
        });
        docx.Packer.toBlob(doc).then(blob => saveAs(blob, `Muba_Certified_${activeName}.docx`));
    }
</script>
</body>
</html>
